{% extends "blogs/base.html" %}
{% load cotton %}

{% block title %}Blog{% endblock %}

{% block meta_description %}
Discover stories, tips, and inspiration for creating personalized children's books. Read our latest blog posts about family, creativity, and the magic of personalized storytelling.
{% endblock %}

{% block content %}

<c-layout._page extra_class="relative z-10 py-16 md:py-24 xl:py-32">
  <!-- Hero Section -->
  <!--TODO: Add an image as a background -->
  <section class="relative overflow-hidden py-12 md:py-16">
    <div class="text-center">
      <h1 class="text-4xl md:text-5xl lg:text-6xl font-heading font-bold mb-4">
        Stories & Inspiration
      </h1>
      <p class="text-lg md:text-xl max-w-2xl mx-auto font-body">
        Explore our collection of stories, tips, and insights about personalized children's books and the joy of creative storytelling
      </p>
    </div>
  </section>
</c-layout._page>

<!-- Main Content -->
<c-layout._section id="main-content" bg_class="bg-transparent" py_class="py-8 md:py-12 xl:py-16">

  {% if featured_post and not active_category and page_obj.number == 1 %}
    
  <!-- Featured Post Section -->
  <div class="mb-12">
    <div class="flex items-center gap-2 mb-6">
      <h2 class="text-2xl md:text-3xl font-heading font-bold">Featured Post</h2>
    </div>
    
    <div class="max-w-xl mx-auto">
      <c-blogs._featured_card :post="featured_post" />
    </div>

  </div>
  {% endif %}

  <!-- Category Filter -->
  {% comment %}
  
  TODO: Component needs fixing 
  {% if categories %}
  <c-blogs._category_filter
          :categories="categories"
          :active_category="active_category"
          />
  {% endif %}
  {% endcomment %}

  {% if blogs and not featured_post %}
  <!-- Section Heading -->
  <h2 class="flex items-center gap-2 text-lg font-heading font-bold text-primary mb-6">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-newspaper-icon lucide-newspaper"><path d="M15 18h-5"/><path d="M18 14h-8"/><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2"/><rect width="8" height="4" x="10" y="6" rx="1"/></svg>
    {% if active_category %}
    {{ active_category.name }}
    {% else %}
    Latest Posts
    {% endif %}
  </h2>

  <!-- Blog Posts Grid -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 lg:gap-8 justify-items-center">
    {% for post in blogs %}
    {% if not featured_post or post.id != featured_post.id or active_category or page_obj.number != 1 %}
    <div class="w-full max-w-xl">
      <c-blogs._blog_card :post="post" />
    </div>
      {% endif %}
      {% endfor %}
  </div>

  <!-- Pagination -->
  <c-blogs._blog_pagination :page_obj="page_obj" />

  {% else %}
  <!-- Empty State -->
  <div class="flex flex-col items-center justify-center py-16 md:py-24">
    <div class="w-32 h-32 mb-6 relative">
      <div class="absolute inset-0 bg-primary/10 rounded-full animate-pulse"></div>
      <div class="absolute inset-0 flex items-center justify-center">
        <span class="iconify lucide--book-open size-16 text-primary/30"></span>
      </div>
    </div>

    <h2 class="text-2xl md:text-3xl font-heading font-bold mb-3 text-base-content">
      {% if active_category %}
      No posts in this category yet
      {% else %}
      No blog posts yet
      {% endif %}
    </h2>

    <p class="text-base-content text-center max-w-md mb-8 font-body">
    {% if active_category %}
    We haven't published any posts in this category yet. Check back soon or explore other categories!
    {% else %}
    We're working on bringing you amazing content. Check back soon for inspiring stories and helpful tips!
    {% endif %}
    </p>

    {% if active_category %}
    <a href="{% url 'blogs:blog_list' %}" class="btn btn-primary gap-2">
      <span class="iconify lucide--arrow-left size-4"></span>
      View All Posts
    </a>
    {% endif %}
  </div>


  {% endif %}
</c-layout._section>
{% endblock %}
