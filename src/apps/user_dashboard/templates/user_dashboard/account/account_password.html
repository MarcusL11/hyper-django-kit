{% extends 'user_dashboard/base.html' %}
{% load partials %}
{% block content %}
    {# Header Section #}
    <div class="card card-border bg-base-300 rounded-box relative w-full overflow-hidden p-6 shrink-0">
      <div class="flex justify-between">
        <div>
          <div class="flex items-center gap-1">
            <a href="{% url 'user_dashboard:index'%}" class="hover:link text-base-content/80 text-sm">Dashboard</a>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="text-base-content/80 size-3.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
            </svg>
            <p class="text-sm">Account</p>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="text-base-content/80 size-3.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
            </svg>
            <p class="text-sm">Password</p>
          </div>
          <p class="text-primary mt-4 text-xl font-medium">
            Change Password
          </p>
          <p class="text-base-content/80">
            Update your password to keep your account secure.
          </p>
        </div>
      </div>
    </div>

    {# Main Content Grid #}
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">

      {# Change Password Form - Left/Main Section #}
      <div class="lg:col-span-8 shrink-0">
        <div class="card card-border bg-base-200 shadow-xl shrink-0">
          <div class="card-body">
            <h2 class="card-title">Change Your Password</h2>
            <p class="text-sm text-base-content/70 mb-4">Update your password to keep your account secure</p>

            {% partialdef password-form-partial inline %}
            <div id="password-form-container">
              <form action="{% url 'user_dashboard:account_password' %}" 
                    method="post" 
                    autocomplete="off"
                    class="space-y-4">
                {% csrf_token %}
                {# Non-field errors #}
                {% if password_form.non_field_errors %}
                <div class="alert alert-error">
                  <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  <span>{{ password_form.non_field_errors.0 }}</span>
                </div>
                {% endif %}

                {# Current Password Field #}
                <div class="form-control">
                  <label class="label">
                    <span class="label-text font-medium">Current Password</span>
                  </label>
                  {% if password_form.oldpassword.errors %}
                  <input type="password"
                         name="{{ password_form.oldpassword.name }}"
                         placeholder="Enter your current password"
                         class="input input-bordered input-error w-full"
                         required
                         autocomplete="current-password">
                  <label class="label">
                    <span class="label-text-alt text-error">{{ password_form.oldpassword.errors.0 }}</span>
                  </label>
                  {% else %}
                  <input type="password"
                         name="{{ password_form.oldpassword.name }}"
                         placeholder="Enter your current password"
                         class="input input-bordered w-full"
                         required
                         autocomplete="current-password">
                  {% endif %}
                </div>

                {# New Password Field #}
                <div class="form-control">
                  <label class="label">
                    <span class="label-text font-medium">New Password</span>
                  </label>
                  {% if password_form.password1.errors %}
                  <input type="password"
                         name="{{ password_form.password1.name }}"
                         placeholder="Enter your new password"
                         class="input input-bordered input-error w-full"
                         required
                         autocomplete="new-password">
                  <label class="label">
                    <span class="label-text-alt text-error">{{ password_form.password1.errors.0 }}</span>
                  </label>
                  {% else %}
                  <input type="password"
                         name="{{ password_form.password1.name }}"
                         placeholder="Enter your new password"
                         class="input input-bordered w-full"
                         required
                         autocomplete="new-password">
                  {% endif %}
                </div>

                {# Confirm New Password Field #}
                <div class="form-control">
                  <label class="label">
                    <span class="label-text font-medium">Confirm New Password</span>
                  </label>
                  {% if password_form.password2.errors %}
                  <input type="password"
                         name="{{ password_form.password2.name }}"
                         placeholder="Confirm your new password"
                         class="input input-bordered input-error w-full"
                         required
                         autocomplete="new-password">
                  <label class="label">
                    <span class="label-text-alt text-error">{{ password_form.password2.errors.0 }}</span>
                  </label>
                  {% else %}
                  <input type="password"
                         name="{{ password_form.password2.name }}"
                         placeholder="Confirm your new password"
                         class="input input-bordered w-full"
                         required
                         autocomplete="new-password">
                  {% endif %}
                </div>

                {# Submit Button #}
                <div class="form-control mt-6">
                  <button type="submit" class="btn btn-primary w-full gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" />
                    </svg>
                    Change Password
                  </button>
                </div>
              </form>
            </div>
            {% endpartialdef password-form-partial %}
          </div>
        </div>
      </div>

      {# Security Tips - Right/Sidebar Section #}
      <div class="lg:col-span-4 shrink-0">
        <div class="card card-border bg-base-200 shadow-xl shrink-0">
          <div class="card-body">
            <h2 class="card-title text-lg">Password Guidelines</h2>

            <div class="space-y-4 mt-4">
              <div class="flex gap-3">
                <div class="shrink-0">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-success">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div>
                  <p class="font-semibold text-sm">Use a strong password</p>
                  <p class="text-xs text-base-content/70">Mix uppercase, lowercase, numbers, and symbols</p>
                </div>
              </div>

              <div class="flex gap-3">
                <div class="shrink-0">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-success">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div>
                  <p class="font-semibold text-sm">Make it unique</p>
                  <p class="text-xs text-base-content/70">Don't reuse passwords from other sites</p>
                </div>
              </div>

              <div class="flex gap-3">
                <div class="shrink-0">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-success">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div>
                  <p class="font-semibold text-sm">Keep it long</p>
                  <p class="text-xs text-base-content/70">Minimum 8 characters recommended</p>
                </div>
              </div>

              <div class="flex gap-3">
                <div class="shrink-0">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-success">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
                <div>
                  <p class="font-semibold text-sm">Consider a password manager</p>
                  <p class="text-xs text-base-content/70">Securely store and generate passwords</p>
                </div>
              </div>
            </div>

            <div class="divider my-4"></div>

            <div class="alert alert-info">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-info shrink-0 w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <div class="text-sm">
                <p class="font-semibold">Forgot your password?</p>
                <p>You can reset it from the login page.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
{% endblock content %}
