{% load static tailwind_tags cotton partials %}
<!doctype html>
<html lang="en">
  <head>
    <title>HyperDjangoKit - {% block title %}{% endblock %}</title>
    <meta charset="UTF-8" />
    <meta name="author" content="HyperDjangoKit" />
    <meta name="keywords" content="Django, SaaS, starter kit, HATEOAS, Python, web development" />
    <meta name="description" content="From Idea to Deployment, Skip the 100-Hour Setup. The complete Django SaaS starter kit built for speed and long-term maintainability." />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    {# Favicons #}
    <link rel="shortcut icon" href="{% static 'images/favicon-dark.png' %}" media="(prefers-color-scheme: dark)" />
    <link rel="shortcut icon" href="{% static 'images/favicon-light.png' %}" media="(prefers-color-scheme: light)" />

    {# Google Fonts - Space Mono & Space Grotesk #}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    {# Main CSS #}
    {% tailwind_css %}
    {# Custom Typography CSS #}
    <link rel="stylesheet" href="{% static 'css/custom.css' %}" />
    <script src="{% static 'js/theme-controller.js' %}"></script>
    <script type="module" src="https://cdn.jsdelivr.net/gh/starfederation/datastar@1.0.0-RC.6/bundles/datastar.js"></script>
    {% block js_head %}{% endblock js_head %}
  </head>

  <body>
    <!--  Start: Drawer Component -->
    <div class="drawer lg:drawer-open">
      <input id="sidebar-drawer" type="checkbox" class="drawer-toggle" />

      <!-- Drawer Content -->
      <div class="drawer-content flex flex-col h-screen">

        <!--  Start: Layout - Topbar -->
        <div
            role="navigation"
            aria-label="Navbar"
            class="navbar bg-base-100 border-b border-base-300 px-10">
          <label
              for="sidebar-drawer"
              class="btn btn-square btn-ghost lg:hidden"
              aria-label="Open menu">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 5.25h16.5m-16.5 4.5h16.5m-16.5 4.5h16.5m-16.5 4.5h16.5" />
            </svg>
          </label>
          <div class="navbar-start">
            <div>
              <p class="leading-none font-medium md:text-lg">
                Good Morning
              <span class="max-sm:hidden">, {{ request.user.first_name|default:request.user.username }}</span>
              </p>
              <p class="text-base-content/60 mt-1 text-sm/none max-sm:hidden">
                Welcome back, great to see you again!
              </p>
            </div>
          </div>
          <div data-signals:theme="false" class="navbar-end gap-1">

            <!-- Theme Toggle -->
            <label class="swap swap-rotate">
              <!-- this hidden checkbox controls the state -->
              <input type="checkbox" data-theme-control="toggle" class="theme-controller" value="dark" />

              <!-- sun icon -->
              <svg
                  class="swap-off h-8 w-8 fill-current"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24">
                <path
                    d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z" />
              </svg>

              <!-- moon icon -->
              <svg
                  class="swap-on h-8 w-8 fill-current"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24">
                <path
                    d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" />
              </svg>
            </label>
          </div>
        </div>
        <!--  End: Layout - Topbar -->

        <!--  Start: Layout - Content -->
        <div id="layout-content" class="flex-1 overflow-auto p-4 sm:p-6">
          <div class="h-full flex flex-col gap-2 mx-auto max-w-8xl">
            <!-- Django's Messages Notification Banner -->
            {% partialdef message-container-partial inline %}
            <div id="message-container" class="justify-center mx-auto z-[1]">
              {% if messages %}
                <div class="space-y-2">
                  {% for message in messages %}
                    {# Django Messages (Success/Error notifications) #}
                    <div class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-error{% elif message.tags == 'warning' %}alert-warning{% else %}alert-info{% endif %}">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                      </svg>
                      <span>{{ message }}</span>
                      <button class="btn btn-ghost btn-sm btn-circle" onclick="this.parentElement.remove();" aria-label="Close">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                      </button>
                    </div>
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            {% endpartialdef message-container-partial %}

            {% block content %}{% endblock content %}
          </div>
        </div>

        <!--  End: Layout - Content -->

        <!-- Footer -->
        <div class="mt-auto border-t border-base-300 bg-base-100">
          <div class="py-2">
            <div class="flex w-full flex-wrap items-center justify-between gap-3 px-4 py-3">
              <a href="{% url 'subscriptions:index' %}" class="btn btn-ghost text-lg"><svg xmlns="http://www.w3.org/2000/svg" width="25px" height="25px" viewBox="0 0 512 512" class="theme-logo"><path d="M29.805 29.777L242.14 209.55H118.712l112.54 86.784H95.995l225.656 174.012-81.537-116.05 66.487.143 179.185 138.175-171.96-244.746h84.568L248.082 29.776H29.805z"/></svg>HyperDjangoKit</a>
              <div
                  class="flex flex-wrap items-center gap-0.5 text-xs *:px-2 *:py-1 *:opacity-70 *:transition-all *:hover:opacity-100 sm:text-sm">
                <a href="#">Terms of Use</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Legal &amp; Compliance</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Drawer Side (Sidebar) -->
      <div class="drawer-side">
        <label for="sidebar-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
        <div class="bg-base-100 min-h-full w-48 flex flex-col border-r border-base-300">
          <!--  Start: Sidebar Header -->
          <div class="flex min-h-16 items-center justify-center gap-3 px-4">
            <a href="{% url 'subscriptions:index' %}" class="btn btn-ghost text-lg"><svg xmlns="http://www.w3.org/2000/svg" width="25px" height="25px" viewBox="0 0 512 512"><path fill="#000000" d="M29.805 29.777L242.14 209.55H118.712l112.54 86.784H95.995l225.656 174.012-81.537-116.05 66.487.143 179.185 138.175-171.96-244.746h84.568L248.082 29.776H29.805z"/></svg>HyperDjangoKit</a>
            </a>
          </div>
          <!--  Start: Sidebar Menu -->
          <div data-signals='{"details":{"account": {{ details_account|yesno:"true,false" }}, "subscription": {{ details_subscription|yesno:"true,false" }}}}'>
            <ul class="menu p-2 space-y-1 w-full">
              <!-- Overview Section -->
              <li class="menu-title">
                <span>Overview</span>
              </li>
              <li>
                <a class="{% if request.resolver_match.url_name == 'index' %}menu-focus{% endif %}" href="{% url 'user_dashboard:index' %}">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25" />
                  </svg>
                  <span class="">Dashboard</span>
                </a>
              </li>

              <!-- Orders -->
              <li>
                <a class="{% if request.resolver_match.url_name == 'orders_list' %}menu-focus{% endif %}" href="{% url 'user_dashboard:orders_list' %}">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z" />
                  </svg>
                  Orders
                </a>
              </li>

              <!-- Account Section -->
              <li>
                <details {% if details_account %}open{% endif %}>
                  <summary data-on:click="$details.account = !$details.account; @post('{% url 'user_dashboard:store_user_sidebar_state' %}', {headers: {'x-csrftoken': '{{ csrf_token }}'}})">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
                    </svg>
                    Account
                  </summary>
                  <ul class="space-y-1">
                    <li>
                      <a class="{% if request.resolver_match.url_name == 'account_profile' %}menu-focus{% endif %}" href="{% url 'user_dashboard:account_profile' %}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        My Profile
                      </a>
                    </li>
                    <li>
                      <a class="{%if request.resolver_match.url_name == 'account_email' %}menu-focus{% endif %}" href="{% url 'user_dashboard:account_email' %}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                        </svg>
                        Email
                      </a>
                    </li>
                    <li>
                      <a class="{%if request.resolver_match.url_name == 'account_password' %}menu-focus{% endif %}" href="{% url 'user_dashboard:account_password' %}">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
                        </svg>
                        Password
                      </a>
                    </li>
                    <li>
                      <a class="{%if request.resolver_match.url_name == 'account_sessions' %}menu-focus{% endif %}" href="{% url 'user_dashboard:account_sessions' %}">
                       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
                        </svg>
                        Sessions
                      </a>
                    </li>
                  </ul>
                </details>
              </li>

              <!-- Subscription Section -->
              <li>
                <details {%if details_subscription %}open{% endif %}>
                  <summary data-on:click="$details.subscription = !$details.subscription; @post('{% url 'user_dashboard:store_user_sidebar_state' %}', {headers: {'x-csrftoken': '{{ csrf_token }}'}})">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3" />
                    </svg>
                    Subscription
                  </summary>
                  <ul class="space-y-1">
                    <li>
                      <a class="{% if request.resolver_match.url_name == 'subscription_management' %}menu-focus{% endif %}"
                         href="{% url 'user_dashboard:subscription_management' %}">
                        Manage Subscription
                      </a>
                    </li>
                    <li>
                      <a class="{% if request.resolver_match.url_name == 'subscription_invoices' %}menu-focus{% endif %}"
                         href="{% url 'user_dashboard:subscription_invoices' %}">
                        Billing & Receipts
                      </a>
                    </li>
                    <li>
                      <a class="{% if request.resolver_match.url_name == 'subscription_plans' %}menu-focus{% endif %}"
                         href="{% url 'user_dashboard:subscription_plans' %}">
                        View Plans
                      </a>
                    </li>
                  </ul>
                </details>
              </li>
            </ul>
          </div>
          <!--  End: Sidebar Menu -->
          <!--  Start: Sidebar Footer -->
          <div class="mt-auto border-base-300 p-2">
            <!-- User Profile Dropdown -->
            <div class="dropdown dropdown-top dropdown-center w-full">
              <div
                  tabindex="0"
                  role="button"
                  class="btn btn-ghost w-full justify-start gap-2 h-auto py-2">
                <div class="avatar">
                  <div class="w-8 rounded-full">
                    {% if user.profile_image %}
                      <img src="{{ user.profile_image.url }}" alt="{{ user.get_full_name|default:user.username }}" />
                    {% else %}
                      <img src="https://img.daisyui.com/images/profile/demo/yellingcat@192.webp" alt="Default Avatar" />
                    {% endif %}
                  </div>
                </div>
                <div class="flex-1 text-left overflow-hidden">
                  <p class="text-sm font-medium truncate">{{ request.user.get_full_name|default:request.user.username }}</p>
                  <p class="text-xs text-base-content/60 truncate">{{ request.user.email }}</p>
                </div>
              </div>
              <ul
                  tabindex="0"
                  class="dropdown-content menu bg-base-100 rounded-box shadow-lg mb-2 w-52 p-2 z-[1]">
                <li>
                  <a href="{% url 'user_dashboard:account_profile' %}">
                    <span>My Profile</span>
                  </a>
                </li>
                {% if request.user.is_staff %}
                <li>
                  <a href="{% url 'admin:index' %}">
                    <span>Access Admin</span>
                  </a>
                </li>
                {% endif %}
                <li>
                  <a href="{% url 'account_logout' %}" class="text-error">
                    <span>Logout</span>
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <!--  End: Sidebar Footer -->
        </div>
      </div>
      <!--  End: Drawer Side (Sidebar) -->
    </div>
    <!--  End: Drawer Structure -->

    <!--  End: Layout - Main -->
    {% block js_body %}{% endblock js_body %}
  </body>
</html>
